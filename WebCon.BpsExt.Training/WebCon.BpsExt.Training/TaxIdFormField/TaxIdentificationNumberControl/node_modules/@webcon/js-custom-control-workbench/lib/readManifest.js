const fs = require('fs');
const path = require('path');

const readManifest = distPath => {
    return new Promise((resolve, reject) => {
        const filePath = path.join(distPath, 'manifest.json');

        if (!fs.existsSync(filePath)) {
            return reject(
                new Error(
                    `Manifest file does not exist. Workbench is intended to be run as a dependency from Form Field Extension JS project.\r\nDirectory ${distPath} should contains Form Field Extension JS project.`
                )
            );
        }

        console.log(`Reading manifest file from ${filePath}`);

        fs.readFile(filePath, (error, data) => {
            if (error) {
                return reject(error);
            }

            resolve(JSON.parse(data));
        });
    });
};

module.exports = readManifest;
